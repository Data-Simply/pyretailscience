version: '3.8'
services:
  spark:
    image: python:3.11
    container_name: pyspark-integration-tests
    volumes:
      - ../../../data:/app/data
      - ../../..:/app/work
    environment:
      - SPARK_DRIVER_MEMORY=512m
      - SPARK_EXECUTOR_MEMORY=512m
      - JAVA_HOME=/usr/lib/jvm/java-17-openjdk-amd64
    working_dir: /app/work
    command: >
      bash -c "
      apt-get update &&
      apt-get install -y openjdk-17-jdk &&
      pip install uv &&
      uv sync --group dev &&
      tail -f /dev/null
      "
